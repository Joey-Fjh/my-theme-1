{% liquid
    assign body_font_bold = settings.type_body_font | font_modify: 'weight', 'bold'
    assign body_font_italic = settings.type_body_font | font_modify: 'style', 'italic'
    assign body_font_bold_italic = body_font_bold | font_modify: 'style', 'italic'
%}

{% style %}
    {%- comment -%} Heading Custom font --- @font-face {%- endcomment -%}
    {% if settings.use_custom_heading_font and settings.custom_heading_font_url != blank %}
        @font-face {
            font-family: {{ settings.custom_heading_font_family | json }};
            src: url({{ settings.custom_heading_font_url | json }}) format("woff2");
            font-style: normal;
            font-weight: 400;
            font-display: swap;
        }
    {% endif %}

    {%- comment -%} Body Custom font --- @font-face {%- endcomment -%}
    {% if settings.use_custom_body_font and settings.custom_body_font_url != blank %}
        @font-face {
            font-family: {{ settings.custom_body_font_family | json }};
            src: url({{ settings.custom_body_font_url | json }}) format("woff2");
            font-style: normal;
            font-weight: 400;
            font-display: swap;
        }
    {% endif %}

    {% unless settings.use_custom_body_font and settings.custom_body_font_url != blank %}
        {{ settings.type_body_font | font_face: font_display: 'swap' }}
        {{ body_font_bold | font_face: font_display: 'swap' }}
        {{ body_font_italic | font_face: font_display: 'swap' }}
        {{ body_font_bold_italic | font_face: font_display: 'swap' }}
    {% endunless %}

    {% unless settings.use_custom_heading_font and settings.custom_heading_font_url != blank %}
        {{ settings.type_header_font | font_face: font_display: 'swap' }}
    {% endunless %}

    {% comment %} color schemes (last result: :root, .color-scheme-1{} .color-scheme-2{} ...) {% endcomment %}
    {% assign scheme_classes = '' %}
    {% for scheme in settings.color_schemes %}
        {% assign scheme_classes = scheme_classes | append: ', .color-' | append: scheme.id %}
        {% if forloop.index == 1 %}
            :root,
        {% endif %}
        .color-{{ scheme.id }} {
            --color-background: {{ scheme.settings.background_color.red }}, {{ scheme.settings.background_color.green }}, {{ scheme.settings.background_color.blue }};
            {% if scheme.settings.background_gradient_color != empty %}
                --gradient-background: {{ scheme.settings.background_gradient_color }};
            {% else %}
                --gradient-background: {{ scheme.settings.background_color }};
            {% endif %}
            
            --color-foreground: {{ scheme.settings.text_color.red }}, {{ scheme.settings.text_color.green }}, {{ scheme.settings.text_color.blue }};
            --color-icons: {{ scheme.settings.icons_color.red }}, {{ scheme.settings.icons_color.green }}, {{ scheme.settings.icons_color.blue }};
            --color-links: {{ scheme.settings.links_color.red }}, {{ scheme.settings.links_color.green }}, {{ scheme.settings.links_color.blue }};
            --color-primary-button: {{ scheme.settings.primary_button_background_color.red }}, {{ scheme.settings.primary_button_background_color.green }}, {{ scheme.settings.primary_button_background_color.blue }};
            --color-primary-button-text: {{ scheme.settings.primary_button_label_color.red }}, {{ scheme.settings.primary_button_label_color.green }}, {{ scheme.settings.primary_button_label_color.blue }};
            --color-primary-button-border: {{ scheme.settings.primary_button_border_color.red }}, {{ scheme.settings.primary_button_border_color.green }}, {{ scheme.settings.primary_button_border_color.blue }};
            --color-secondary-button: {{ scheme.settings.secondary_button_background_color.red }}, {{ scheme.settings.secondary_button_background_color.green }}, {{ scheme.settings.secondary_button_background_color.blue }};
            --color-secondary-button-text: {{ scheme.settings.secondary_button_label_color.red }}, {{ scheme.settings.secondary_button_label_color.green }}, {{ scheme.settings.secondary_button_label_color.blue }};
            --color-secondary-button-border: {{ scheme.settings.secondary_button_border_color.red }}, {{ scheme.settings.secondary_button_border_color.green }}, {{ scheme.settings.secondary_button_border_color.blue }};
        }
    {% endfor %}

    {% comment %} last result: body, .color-sheme-1{}, .color-sheme-2{} ... {% endcomment %}
    {{ scheme_classes | prepend: 'body' }} {
        color: rgba(var(--color-foreground));
        background-color: rgba(var(--color-background));
    }

    :root {
        {%- comment -%} global Variables {%- endcomment -%}
        --announcement-bar-height: 0px;
        --header-height: 0px;
        
        {% comment %} layout Variables {% endcomment %}
        --page-width: {{ settings.page_width | divided_by: 10}}rem;
        --page-margin: {{ settings.page_margin | divided_by: 10 }}rem;
        --section-padding-top: {{ settings.section_padding_top }}px;
        --section-padding-bottom: {{ settings.section_padding_bottom }}px;
        
        {% comment %} font Variables {% endcomment %}
        {% if settings.use_custom_body_font and settings.custom_body_font_url != blank %}
            --font-body-family: {{ settings.custom_body_font_family | json }}, {{ settings.type_body_font.fallback_families }};
            --font-body-style: normal;
            --font-body-weight: 400;
        {%- else -%}
            --font-body-family: {{ settings.type_body_font.family }}, {{ settings.type_body_font.fallback_families }};
            --font-body-style: {{ settings.type_body_font.style }};
            --font-body-weight: {{ settings.type_body_font.weight }};
        {% endif %}
        
        {% if settings.use_custom_heading_font and settings.custom_heading_font_url != blank %}
            --font-heading-family: {{ settings.custom_heading_font_family | json }}, {{ settings.type_header_font.fallback_families }};
            --font-heading-style: normal;
            --font-heading-weight: 400;
        {% else %}
            --font-heading-family: {{ settings.type_header_font.family }}, {{ settings.type_header_font.fallback_families }};
            --font-heading-style: {{ settings.type_header_font.style }};
            --font-heading-weight: {{ settings.type_header_font.weight }};
        {% endif %}
        
        --font-body-scale: {{ settings.body_scale | divided_by: 100.0 }};
        --font-heading-scale: {{ settings.heading_scale | times: 1.0 | divided_by: settings.body_scale }};
        
        {% comment %} input Variables {% endcomment %}
        --input-radius: {{ settings.input_radius }}px;
        --input-border-width: {{ settings.input_border_thickness }}px;
        --input-shadow-opacity: {{ settings.input_shadow_opacity | divided_by: 100.0 }};
        --input-shadow-horizontal-offset: {{ settings.input_shadow_horizontal_offset }}px;
        --input-shadow-vertical-offset: {{ settings.input_shadow_vertical_offset }}px;
        --input-shadow-blur-radius: {{ settings.input_shadow_blur }}px;
        
        --input-margin-offset: {% if settings.input_shadow_vertical_offset != 0 and settings.input_shadow_opacity > 0 %}{{ settings.input_shadow_vertical_offset | abs }}{% else %}0{% endif %}px;
        --inputs-radius-outset: {% if settings.input_radius > 0 %}{{ settings.input_radius | plus: settings.input_border_thickness }}{% else %}0{% endif %}px; 
    }
{% endstyle %}
